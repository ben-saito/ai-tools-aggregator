
<div
  id="comparison-bar"
  class="fixed bottom-0 left-0 right-0 z-50 transform border-t border-[var(--color-border-primary)] bg-[var(--color-bg-elevated)] p-3 shadow-lg transition-transform duration-300 translate-y-full sm:p-4"
>
  <div class="mx-auto flex max-w-7xl flex-col items-start gap-3 sm:flex-row sm:items-center sm:justify-between sm:gap-4">
    <div class="flex w-full items-center justify-between gap-2 sm:w-auto sm:gap-4">
      <span class="text-sm font-medium text-[var(--color-text-primary)]">
        <span id="comparison-count">0</span> tools selected
      </span>
      <div id="comparison-thumbnails" class="flex gap-2">
        {/* Thumbnails will be injected here */}
      </div>
    </div>
    <div class="flex w-full items-center justify-between gap-3 sm:w-auto">
      <button
        id="clear-comparison"
        class="min-h-[44px] min-w-[44px] text-sm text-[var(--color-text-tertiary)] transition-colors hover:text-[var(--color-text-primary)]"
      >
        Clear
      </button>
      <a
        href="/compare"
        id="compare-button"
        class="flex-1 rounded-lg bg-primary-600 px-4 py-3 text-center text-sm font-medium text-white transition-colors hover:bg-primary-700 sm:flex-none sm:py-2"
      >
        Compare Now
      </a>
    </div>
  </div>
</div>

<script>
  import { selectedToolsMap, clearComparison } from '../stores/comparisonStore';

  const bar = document.getElementById('comparison-bar');
  const countSpan = document.getElementById('comparison-count');
  const clearBtn = document.getElementById('clear-comparison');
  const compareBtn = document.getElementById('compare-button') as HTMLAnchorElement;

  selectedToolsMap.subscribe(tools => {
    const selectedIds = Object.keys(tools);
    const count = selectedIds.length;

    if (countSpan) countSpan.textContent = count.toString();

    if (count > 0) {
      bar?.classList.remove('translate-y-full');
    } else {
      bar?.classList.add('translate-y-full');
    }

    // Update link
    if (compareBtn) {
      compareBtn.href = `/compare?tools=${selectedIds.join(',')}`;
    }
  });

  clearBtn?.addEventListener('click', () => {
    clearComparison();
  });
</script>
