---
---

<div class="rounded-xl border border-gray-100 bg-gray-50 p-6 shadow-sm">
  <div class="text-center">
    <h3 class="text-lg font-bold text-gray-900">Subscribe on the Weekly Digest</h3>
    <p class="mt-2 text-sm text-gray-600">Get the top 5 trending AI tools delivered to your inbox every week.</p>
  </div>

  <form id="newsletter-form" class="mt-4 flex gap-2">
    <input
      type="email"
      name="email"
      required
      placeholder="Enter your email"
      class="w-full rounded-lg border-gray-300 px-4 py-2 shadow-sm focus:border-blue-500 focus:ring-blue-500"
    />
    <button
      type="submit"
      class="whitespace-nowrap rounded-lg bg-blue-600 px-4 py-2 font-semibold text-white shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
    >
      Subscribe
    </button>
  </form>
  <p id="newsletter-message" class="mt-2 hidden text-center text-sm font-medium"></p>
</div>

<script>
  const form = document.getElementById('newsletter-form') as HTMLFormElement;
  const messageEl = document.getElementById('newsletter-message');

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const formData = new FormData(form);
    const email = formData.get('email');

    if (!messageEl) return;

    try {
      const response = await fetch('/api/newsletter/subscribe', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ email }),
      });

      const data = await response.json();

      if (response.ok) {
        messageEl.textContent = 'Thanks for subscribing!';
        messageEl.classList.remove('hidden', 'text-red-500');
        messageEl.classList.add('text-green-600');
        form.reset();
      } else {
        throw new Error(data.message || 'Subscription failed');
      }
    } catch (error: any) {
      console.error('Newsletter error:', error);
      messageEl.textContent = error.message || 'Something went wrong. Please try again.';
      messageEl.classList.remove('hidden', 'text-green-600');
      messageEl.classList.add('text-red-500');
    }
  });
</script>
