---
---

<div class="rounded-xl border border-[var(--color-border-primary)] bg-[var(--color-bg-secondary)] p-6 shadow-[var(--shadow-card)]">
  <div class="text-center">
    <h3 class="text-lg font-bold text-[var(--color-text-primary)]">Subscribe on the Weekly Digest</h3>
    <p class="mt-2 text-sm text-[var(--color-text-secondary)]">Get the top 5 trending AI tools delivered to your inbox every week.</p>
  </div>

  <form id="newsletter-form" class="mt-4 flex gap-2">
    <input
      type="email"
      name="email"
      required
      placeholder="Enter your email"
      class="w-full rounded-lg border border-[var(--color-border-primary)] bg-[var(--color-bg-elevated)] px-4 py-2 text-[var(--color-text-primary)] shadow-sm transition-all focus:border-primary-500 focus:ring-primary-500"
    />
    <button
      type="submit"
      class="whitespace-nowrap rounded-lg bg-primary-600 px-4 py-2 font-semibold text-white shadow-sm transition-colors hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"
    >
      Subscribe
    </button>
  </form>
  <p id="newsletter-message" class="mt-2 hidden text-center text-sm font-medium"></p>
</div>

<script>
  const form = document.getElementById('newsletter-form') as HTMLFormElement;
  const messageEl = document.getElementById('newsletter-message');

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const formData = new FormData(form);
    const email = formData.get('email');

    if (!messageEl) return;

    try {
      const response = await fetch('/api/newsletter/subscribe', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ email }),
      });

      const data = await response.json();

      if (response.ok) {
        messageEl.textContent = 'Thanks for subscribing!';
        messageEl.classList.remove('hidden', 'text-red-500');
        messageEl.classList.add('text-green-600');
        form.reset();
      } else {
        throw new Error(data.message || 'Subscription failed');
      }
    } catch (error: any) {
      console.error('Newsletter error:', error);
      messageEl.textContent = error.message || 'Something went wrong. Please try again.';
      messageEl.classList.remove('hidden', 'text-green-600');
      messageEl.classList.add('text-red-500');
    }
  });
</script>
